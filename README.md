# mouse_abi_tool
 Tool to pull gene expression from Allen Brain Institute API in same annotation space as structural connectome.

View `code/misc/packages.R` to find the prerequisite packages.

Open the file pipeline.R. Set the variable `basedir` to a string with the local path to this repository. Then run `pipeline.R` in order to sequentially execute the following scripts:
	- `packages.R`: load all packages
	- `directories.R`: establish results folder directory structure
	- `process.R`: create connectivity matrix and get region names. These connectivity matrices are from Oh et al. 2014, and the static data files Connectome_Contra.csv and Connectome_Ipsi.csv were generated by Mike Henderson at the University of Pennsylvania (see my other repository `connectome_diffusion`).
	- `process_ontology.R`: download ABA brain structure ontology
	- `download_gene_expression.R`: download each gene's expression for the structures in the connectivity matrix one at a time from Allen Brain API
	- `probenormalization_selection.R`: normalize each probe's expression with a sigmoid function and average expression across all available probes for each gene

Please direct any questions to Eli D0T Cornblath @t pennmedicine dºt upenn do† edu